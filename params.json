{"name":"Mapp.js","tagline":"mobile app ","body":"# mapp.js\r\nmobile app \r\n\r\n\r\n---------------------------\r\n依赖\r\n\r\n* [jquery.js](http://jquery.com/) or [zepto.js](http://zeptojs.com/)\r\n* [history.js](https://github.com/browserstate/history.js/)\r\n* [routeMatcher](https://github.com/GENGSHUANGs/javascript-route-matcher/)\r\n* [microevent.js](https://github.com/GENGSHUANGs/microevent.js '定制版')`\r\n\r\nUSAGE:\r\n\r\n```css\r\nhtml,body{\r\n\tmargin:0px;\r\n\tpadding:0px;\r\n\twidth:100%;\r\n\theight:100%;\r\n\tdisplay:block;\r\n}\r\n\r\n.welcome{width:100%;\r\n\theight:100%;\r\n\tdisplay:block;\r\n\tposition:absolute;\r\n\tleft:0px;\r\n\ttop:0px;\r\n\ttext-align:center;\r\n\tz-index:2;\r\n}\r\n\r\nul.app{list-style:none;\r\n\tpadding:0px;\r\n\tmargin:0px;\r\n\tdisplay:block;\r\n\twidth:100%;\r\n\theight:100%;\r\n\tposition:relative;\r\n}\r\n\r\nul.app li.app-page-container{margin:0px;\r\n\tpadding:0px;\r\n\twidth:100%;\r\n\theight:100%;\r\n\tdisplay:block;\r\n\tleft:0px;\r\n\ttop:0px;\r\n}\r\n```\r\n\r\n```html\r\n<ul class=\"app\">\r\n</ul>\r\n<script type=\"text/template\" id=\"page-container-template\">\r\n\t<li class=\"app-page-container\" />\r\n</script>\r\n\r\n<div class=\"welcome\" >\r\n欢迎使用Xxxxx (ver 1.0)\r\n</div>\r\n\r\n<script src=\"jquery.js or zepto.js\" ></script>\r\n<script src=\"history.js\" ></script>\r\n<script src=\"javascript-route-matcher.js\" ></script>\r\n<script src=\"microevent.js\" ></script>\r\n<script src=\"mapp.js\" ></script>\r\n```\r\n\r\n```javascript\r\n(function(window,$,Mapp,undefined){\r\n\t'use strict' ;\r\n\r\n\t/**\r\n\t主页资源 */\r\n\tvar HomeResource = function(){\r\n\t\tMapp.Resource.prototype.constructor.apply(this,arguments);\r\n\t\t// do something else\r\n\t};\r\n\r\n\t$.extend(HomeResource.prototype,Mapp.Resource.prototype);\r\n\r\n\t/**\r\n\t开始附加资源 \r\n\t@param initiative {boolean} : 是否主动(如果使用前进或者后退激活的情况，该值为false) \r\n\t@param app {Mapp} : \r\n\t@param hash {string} : URL(不包含域名部分，以根 \"/\" 开始) \r\n\t@param haspreresource {boolean} : 是否存在上一个资源(第一页 false ，其它true ) \r\n\t@param triggerback {function} : 回调函数(此函数必须被调用，否则，mapp.js 将无法知道本次 on_attach 是否完成，会一致等待！) */\r\n\tHomeResource.prototype.on_attach = function(initiative,app,hash,haspreresource,triggerback){\r\n\t\tvar self = this;\r\n\t\t$.get(hash,function(html){\r\n\t\t\t$(self.container).append(html);\r\n\t\t\ttriggerback();\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t资源附加完成(参数说明，参考on_attach) */\r\n\tHomeResource.prototype.on_attached = function(initiative,app,hash,haspreresource,triggerback){\r\n\t\tthis._request_config_data(this.updateUi.bind(this));\r\n\t};\r\n\r\n\t/**\r\n\t资源开始卸载 */\r\n\tHomeResource.prototype.on_detach = function(initiative,app,hash,triggerback){\r\n\t\t// do something\r\n\t\ttriggerback();\r\n\t};\r\n\r\n\t/**\r\n\t资源卸载完成 */\r\n\tHomeResource.prototype.on_detached = function(initiative,app,hash,triggerback){\r\n\t\t// do something\r\n\t\ttriggerback();\r\n\t};\r\n\r\n\tHomeResource.prototype._request_config_data = function(callback){\r\n\t\t$.getJSON('/app/' + this.params.id + '/home/conf.json',callback);\r\n\t};\r\n\r\n\tHomeResource.prototype.updateUi = function(conf){\r\n\t\t// update ui by config data\r\n\t};\r\n\r\n\t/**\r\n\t初始化app */\r\n\tvar app = new Mapp('.app',{\r\n\t\t// 配置域管理器\r\n\t\tscope:$.extend({\r\n\t\t\tbuild_container:function(dom){\r\n\t\t\t\treturn $($('#page-container-template').html()).appendTo(dom);\r\n\t\t\t}\r\n\t\t},Mapp.default_page_scope),\r\n\t\t// 配置路由\r\n\t\trouters:{\r\n\t\t\t'/app/:id/home.html':function(app,route,hash,params){\r\n\t\t\t\treturn new HomeResource(app,route,hash,params);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t启动app(startup函数接收一个回调函数) */\r\n\tapp.startup(function(){ // startup done\r\n\t\t// 代理链接\r\n\t\t$(document.body).on('click','a',function(){\r\n\t\t\tapp.redirect($(this).attr('href'));\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t// 隐藏欢迎页 \r\n\t\t$('.welcome').hide(); \r\n\t\t// 跳转到首页\r\n\t\tapp.redirect('/app/00001/home.html'); \r\n\t});\r\n})(window,window.jQuery || window.Zepto,window.Mapp);\r\n```","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}